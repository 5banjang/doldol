import{y as le,f as Re,o as Ze,d as _e,j as r,h as Be,g as $e,R as Ge,z as He,B,n as O,r as R,A as Ve,D as Xe,w as Ue,E as qe}from"./index-DB6vBchE.js";import{c as Pe,V as k,T as I,e as q,B as se,H as Ye,u as Je,C as Ke}from"./text-7JXhlaRQ.js";function Qe(a,n,o){return(a-n)*100/(o-n)}le({"0%":{strokeDasharray:"1, 400",strokeDashoffset:"0"},"50%":{strokeDasharray:"400, 400",strokeDashoffset:"-100"},"100%":{strokeDasharray:"400, 400",strokeDashoffset:"-260"}});le({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}});const et=le({"0%":{left:"-40%"},"100%":{left:"100%"}}),tt=le({from:{backgroundPosition:"1rem 0"},to:{backgroundPosition:"0 0"}});function rt(a){const{value:n=0,min:o,max:s,valueText:m,getValueText:d,isIndeterminate:x,role:y="progressbar"}=a,w=Qe(n,o,s);return{bind:{"data-indeterminate":x?"":void 0,"aria-valuemax":s,"aria-valuemin":o,"aria-valuenow":x?void 0:n,"aria-valuetext":(()=>{if(n!=null)return typeof d=="function"?d(n,w):m})(),role:y},percent:w,value:n}}const[at,nt]=$e({name:"ProgressStylesContext",errorMessage:`useProgressStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Progress />" `}),ot=Re((a,n)=>{const{min:o,max:s,value:m,isIndeterminate:d,role:x,...y}=a,w=rt({value:m,min:o,max:s,isIndeterminate:d,role:x}),T={height:"100%",...nt().filledTrack};return r.jsx(Be.div,{ref:n,style:{width:`${w.percent}%`,...y.style},...w.bind,...y,__css:T})}),Ae=Re((a,n)=>{const{value:o,min:s=0,max:m=100,hasStripe:d,isAnimated:x,children:y,borderRadius:w,isIndeterminate:S,"aria-label":T,"aria-labelledby":A,"aria-valuetext":G,title:Z,role:X,...Y}=Ze(a),v=_e("Progress",a),_=w??v.track?.borderRadius,J={animation:`${tt} 1s linear infinite`},H={...!S&&d&&x&&J,...S&&{position:"absolute",willChange:"left",minWidth:"50%",animation:`${et} 1s ease infinite normal none running`}},K={overflow:"hidden",position:"relative",...v.track};return r.jsx(Be.div,{ref:n,borderRadius:_,__css:K,...Y,children:r.jsxs(at,{value:v,children:[r.jsx(ot,{"aria-label":T,"aria-labelledby":A,"aria-valuetext":G,min:s,max:m,value:o,isIndeterminate:S,css:H,borderRadius:_,title:Z,role:X}),y]})})});Ae.displayName="Progress";const it=Pe({displayName:"RepeatIcon",path:r.jsxs("g",{fill:"currentColor",children:[r.jsx("path",{d:"M10.319,4.936a7.239,7.239,0,0,1,7.1,2.252,1.25,1.25,0,1,0,1.872-1.657A9.737,9.737,0,0,0,9.743,2.5,10.269,10.269,0,0,0,2.378,9.61a.249.249,0,0,1-.271.178l-1.033-.13A.491.491,0,0,0,.6,9.877a.5.5,0,0,0-.019.526l2.476,4.342a.5.5,0,0,0,.373.248.43.43,0,0,0,.062,0,.5.5,0,0,0,.359-.152l3.477-3.593a.5.5,0,0,0-.3-.844L5.15,10.172a.25.25,0,0,1-.2-.333A7.7,7.7,0,0,1,10.319,4.936Z"}),r.jsx("path",{d:"M23.406,14.1a.5.5,0,0,0,.015-.526l-2.5-4.329A.5.5,0,0,0,20.546,9a.489.489,0,0,0-.421.151l-3.456,3.614a.5.5,0,0,0,.3.842l1.848.221a.249.249,0,0,1,.183.117.253.253,0,0,1,.023.216,7.688,7.688,0,0,1-5.369,4.9,7.243,7.243,0,0,1-7.1-2.253,1.25,1.25,0,1,0-1.872,1.656,9.74,9.74,0,0,0,9.549,3.03,10.261,10.261,0,0,0,7.369-7.12.251.251,0,0,1,.27-.179l1.058.127a.422.422,0,0,0,.06,0A.5.5,0,0,0,23.406,14.1Z"})]})}),st=Pe({d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z",displayName:"ArrowBackIcon"}),lt=O(B),je=O(I),Fe=({items:a})=>{const n=Ge.useMemo(()=>{const o=[];for(let s=0;s<10;s++)o.push(...He(a));return o.slice(0,20)},[a]);return r.jsxs(B,{position:"relative",w:"full",h:"400px",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",bg:"linear-gradient(135deg, #FF6B6B 0%, #4ECDC4 100%)",borderRadius:"xl",boxShadow:"xl",children:[r.jsx(lt,{position:"absolute",top:0,left:0,right:0,bottom:0,bg:"radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%)",animate:{scale:[1,1.2,1],rotate:[0,180,360]},transition:{duration:3,repeat:1/0,ease:"linear"}}),r.jsxs(B,{position:"relative",w:"300px",h:"200px",bg:"white",borderRadius:"lg",border:"4px solid white",boxShadow:"inset 0 0 20px rgba(0,0,0,0.1)",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center",children:[r.jsx(k,{gap:2,position:"absolute",w:"full",children:n.slice(0,5).map((o,s)=>r.jsx(je,{fontSize:"lg",fontWeight:"bold",color:"#2D3748",textAlign:"center",px:4,py:2,w:"full",initial:{y:-100,opacity:0},animate:{y:[0,100],opacity:[1,0]},transition:{duration:.6,delay:s*.1,repeat:1/0,repeatDelay:2},children:o.text},`${o.id}-${s}`))}),r.jsx(B,{position:"absolute",top:"45%",left:0,right:0,h:"2px",bg:"#FF6B6B",zIndex:2}),r.jsx(B,{position:"absolute",top:"55%",left:0,right:0,h:"2px",bg:"#FF6B6B",zIndex:2})]}),r.jsx(je,{position:"absolute",bottom:"20px",fontSize:"sm",color:"white",fontWeight:"medium",animate:{opacity:[.7,1,.7]},transition:{duration:1,repeat:1/0},children:"뽑는 중..."})]})},ct=O(se),Te=O(B),dt=({onStart:a,gameStats:n,itemCount:o})=>r.jsxs(k,{spacing:6,children:[r.jsx(Te,{initial:{scale:0},animate:{scale:1},transition:{delay:.3,type:"spring"},children:r.jsxs(q,{colorScheme:"purple",fontSize:"lg",px:4,py:2,borderRadius:"full",textAlign:"center",children:["🏆 레벨 ",n.level," (XP: ",n.xp,")"]})}),r.jsxs(k,{spacing:2,children:[r.jsx(I,{fontSize:"xl",fontWeight:"bold",color:"#FF6B6B",textAlign:"center",children:"🎯 가챠 준비 완료!"}),r.jsxs(I,{fontSize:"md",color:"gray.600",textAlign:"center",children:[o,"개의 항목에서 하나를 뽑아보세요"]}),r.jsx(I,{fontSize:"sm",color:"gray.500",textAlign:"center",children:"💡 타이밍을 맞춰서 더 많은 XP를 획득하세요!"})]}),r.jsx(ct,{size:"xl",colorScheme:"red",onClick:a,px:12,py:8,fontSize:"2xl",fontWeight:"bold",borderRadius:"full",boxShadow:"0 8px 25px rgba(255, 107, 107, 0.4)",_hover:{transform:"translateY(-3px)",boxShadow:"0 12px 30px rgba(255, 107, 107, 0.5)"},_active:{transform:"translateY(-1px)"},initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{delay:.6,type:"spring",stiffness:260,damping:20},whileHover:{scale:1.05},whileTap:{scale:.95},children:"🎲 뽑기 시작!"}),r.jsx(Te,{position:"absolute",w:"200px",h:"80px",borderRadius:"full",border:"3px solid #FF6B6B",opacity:.3,zIndex:-1,animate:{scale:[1,1.3,1],opacity:[.3,0,.3]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}}),r.jsxs(k,{spacing:1,pt:4,children:[r.jsxs(I,{fontSize:"xs",color:"gray.500",children:["총 가챠: ",n.totalGachas,"회 | 완벽 타이밍: ",n.perfectTimings,"회"]}),n.achievements.length>0&&r.jsxs(I,{fontSize:"xs",color:"purple.500",children:["🏅 달성 업적: ",n.achievements.length,"개"]})]})]}),ut=O(se),ht=O(B),pt=({timingGame:a,onStop:n,animationDuration:o})=>{const[s,m]=R.useState(0),[d,x]=R.useState(o);R.useEffect(()=>{if(!a.isActive)return;const S=Date.now(),T=setInterval(()=>{const A=Date.now()-S,G=A/o*100,Z=Math.max(0,o-A);m(Math.min(100,G)),x(Z),A>=o&&(clearInterval(T),n("miss"))},16);return()=>clearInterval(T)},[a.isActive,o,n]);const y=()=>{const S=Date.now()-a.startTime;let T;S>=a.targetZoneStart&&S<=a.targetZoneEnd?T="perfect":S>=a.targetZoneStart-500&&S<a.targetZoneStart||S>a.targetZoneEnd&&S<=a.targetZoneEnd+500?T="good":T="miss",n(T)},w=()=>{const S=a.targetZoneStart/o*100,T=a.targetZoneEnd/o*100;return s>=S&&s<=T?"green.400":"yellow.400"};return a.isActive?r.jsxs(k,{spacing:4,w:"full",maxW:"400px",children:[r.jsxs(B,{w:"full",position:"relative",children:[r.jsx(Ae,{value:s,size:"lg",colorScheme:s>=50&&s<=83?"green":"red",bg:"gray.200",borderRadius:"full",height:"20px"}),r.jsx(B,{position:"absolute",top:"0",left:"50%",width:"33%",height:"20px",bg:"green.200",borderRadius:"full",border:"2px solid",borderColor:"green.400",opacity:.7}),r.jsx(ht,{position:"absolute",top:"-5px",left:`${s}%`,transform:"translateX(-50%)",w:"10px",h:"30px",bg:w(),borderRadius:"full",border:"2px solid white",boxShadow:"0 2px 8px rgba(0,0,0,0.3)",animate:{scale:[1,1.2,1]},transition:{duration:.5,repeat:1/0}})]}),r.jsxs(k,{spacing:2,children:[r.jsx(q,{colorScheme:s>=50&&s<=83?"green":"red",fontSize:"md",px:3,py:1,borderRadius:"full",children:s>=50&&s<=83?"🎯 완벽 존!":"⚡ 타이밍을 노려보세요!"}),r.jsxs(I,{fontSize:"sm",color:"gray.600",children:["남은 시간: ",(d/1e3).toFixed(1),"초"]})]}),r.jsx(ut,{size:"xl",colorScheme:s>=50&&s<=83?"green":"orange",onClick:y,px:10,py:6,fontSize:"xl",fontWeight:"bold",borderRadius:"full",boxShadow:"0 6px 20px rgba(0,0,0,0.2)",_hover:{transform:"translateY(-2px)",boxShadow:"0 8px 25px rgba(0,0,0,0.3)"},_active:{transform:"translateY(0)"},animate:{scale:s>=50&&s<=83?[1,1.1,1]:1,boxShadow:s>=50&&s<=83?["0 6px 20px rgba(0,0,0,0.2)","0 8px 30px rgba(34, 197, 94, 0.4)","0 6px 20px rgba(0,0,0,0.2)"]:"0 6px 20px rgba(0,0,0,0.2)"},transition:{duration:.3,repeat:s>=50&&s<=83?1/0:0},whileHover:{scale:1.05},whileTap:{scale:.95},children:"⏹️ 스톱!"}),r.jsx(I,{fontSize:"xs",color:"gray.500",textAlign:"center",children:"녹색 영역에서 멈추면 완벽한 타이밍! +15 XP 획득"})]}):null};var ve={};(function a(n,o,s,m){var d=!!(n.Worker&&n.Blob&&n.Promise&&n.OffscreenCanvas&&n.OffscreenCanvasRenderingContext2D&&n.HTMLCanvasElement&&n.HTMLCanvasElement.prototype.transferControlToOffscreen&&n.URL&&n.URL.createObjectURL),x=typeof Path2D=="function"&&typeof DOMMatrix=="function",y=function(){if(!n.OffscreenCanvas)return!1;var t=new OffscreenCanvas(1,1),e=t.getContext("2d");e.fillRect(0,0,1,1);var i=t.transferToImageBitmap();try{e.createPattern(i,"no-repeat")}catch{return!1}return!0}();function w(){}function S(t){var e=o.exports.Promise,i=e!==void 0?e:n.Promise;return typeof i=="function"?new i(t):(t(w,w),null)}var T=function(t,e){return{transform:function(i){if(t)return i;if(e.has(i))return e.get(i);var c=new OffscreenCanvas(i.width,i.height),u=c.getContext("2d");return u.drawImage(i,0,0),e.set(i,c),c},clear:function(){e.clear()}}}(y,new Map),A=function(){var t=Math.floor(16.666666666666668),e,i,c={},u=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(e=function(h){var p=Math.random();return c[p]=requestAnimationFrame(function l(f){u===f||u+t-1<f?(u=f,delete c[p],h()):c[p]=requestAnimationFrame(l)}),p},i=function(h){c[h]&&cancelAnimationFrame(c[h])}):(e=function(h){return setTimeout(h,t)},i=function(h){return clearTimeout(h)}),{frame:e,cancel:i}}(),G=function(){var t,e,i={};function c(u){function h(p,l){u.postMessage({options:p||{},callback:l})}u.init=function(l){var f=l.transferControlToOffscreen();u.postMessage({canvas:f},[f])},u.fire=function(l,f,b){if(e)return h(l,null),e;var j=Math.random().toString(36).slice(2);return e=S(function(M){function F(C){C.data.callback===j&&(delete i[j],u.removeEventListener("message",F),e=null,T.clear(),b(),M())}u.addEventListener("message",F),h(l,j),i[j]=F.bind(null,{data:{callback:j}})}),e},u.reset=function(){u.postMessage({reset:!0});for(var l in i)i[l](),delete i[l]}}return function(){if(t)return t;if(!s&&d){var u=["var CONFETTI, SIZE = {}, module = {};","("+a.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{t=new Worker(URL.createObjectURL(new Blob([u])))}catch(h){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("🎊 Could not load worker",h),null}c(t)}return t}}(),Z={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function X(t,e){return e?e(t):t}function Y(t){return t!=null}function v(t,e,i){return X(t&&Y(t[e])?t[e]:Z[e],i)}function _(t){return t<0?0:Math.floor(t)}function J(t,e){return Math.floor(Math.random()*(e-t))+t}function $(t){return parseInt(t,16)}function te(t){return t.map(H)}function H(t){var e=String(t).replace(/[^0-9a-f]/gi,"");return e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),{r:$(e.substring(0,2)),g:$(e.substring(2,4)),b:$(e.substring(4,6))}}function K(t){var e=v(t,"origin",Object);return e.x=v(e,"x",Number),e.y=v(e,"y",Number),e}function be(t){t.width=document.documentElement.clientWidth,t.height=document.documentElement.clientHeight}function L(t){var e=t.getBoundingClientRect();t.width=e.width,t.height=e.height}function ce(t){var e=document.createElement("canvas");return e.style.position="fixed",e.style.top="0px",e.style.left="0px",e.style.pointerEvents="none",e.style.zIndex=t,e}function de(t,e,i,c,u,h,p,l,f){t.save(),t.translate(e,i),t.rotate(h),t.scale(c,u),t.arc(0,0,1,p,l,f),t.restore()}function ue(t){var e=t.angle*(Math.PI/180),i=t.spread*(Math.PI/180);return{x:t.x,y:t.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:t.startVelocity*.5+Math.random()*t.startVelocity,angle2D:-e+(.5*i-Math.random()*i),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:t.color,shape:t.shape,tick:0,totalTicks:t.ticks,decay:t.decay,drift:t.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:t.gravity*3,ovalScalar:.6,scalar:t.scalar,flat:t.flat}}function he(t,e){e.x+=Math.cos(e.angle2D)*e.velocity+e.drift,e.y+=Math.sin(e.angle2D)*e.velocity+e.gravity,e.velocity*=e.decay,e.flat?(e.wobble=0,e.wobbleX=e.x+10*e.scalar,e.wobbleY=e.y+10*e.scalar,e.tiltSin=0,e.tiltCos=0,e.random=1):(e.wobble+=e.wobbleSpeed,e.wobbleX=e.x+10*e.scalar*Math.cos(e.wobble),e.wobbleY=e.y+10*e.scalar*Math.sin(e.wobble),e.tiltAngle+=.1,e.tiltSin=Math.sin(e.tiltAngle),e.tiltCos=Math.cos(e.tiltAngle),e.random=Math.random()+2);var i=e.tick++/e.totalTicks,c=e.x+e.random*e.tiltCos,u=e.y+e.random*e.tiltSin,h=e.wobbleX+e.random*e.tiltCos,p=e.wobbleY+e.random*e.tiltSin;if(t.fillStyle="rgba("+e.color.r+", "+e.color.g+", "+e.color.b+", "+(1-i)+")",t.beginPath(),x&&e.shape.type==="path"&&typeof e.shape.path=="string"&&Array.isArray(e.shape.matrix))t.fill(re(e.shape.path,e.shape.matrix,e.x,e.y,Math.abs(h-c)*.1,Math.abs(p-u)*.1,Math.PI/10*e.wobble));else if(e.shape.type==="bitmap"){var l=Math.PI/10*e.wobble,f=Math.abs(h-c)*.1,b=Math.abs(p-u)*.1,j=e.shape.bitmap.width*e.scalar,M=e.shape.bitmap.height*e.scalar,F=new DOMMatrix([Math.cos(l)*f,Math.sin(l)*f,-Math.sin(l)*b,Math.cos(l)*b,e.x,e.y]);F.multiplySelf(new DOMMatrix(e.shape.matrix));var C=t.createPattern(T.transform(e.shape.bitmap),"no-repeat");C.setTransform(F),t.globalAlpha=1-i,t.fillStyle=C,t.fillRect(e.x-j/2,e.y-M/2,j,M),t.globalAlpha=1}else if(e.shape==="circle")t.ellipse?t.ellipse(e.x,e.y,Math.abs(h-c)*e.ovalScalar,Math.abs(p-u)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI):de(t,e.x,e.y,Math.abs(h-c)*e.ovalScalar,Math.abs(p-u)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI);else if(e.shape==="star")for(var g=Math.PI/2*3,P=4*e.scalar,E=8*e.scalar,z=e.x,N=e.y,V=5,D=Math.PI/V;V--;)z=e.x+Math.cos(g)*E,N=e.y+Math.sin(g)*E,t.lineTo(z,N),g+=D,z=e.x+Math.cos(g)*P,N=e.y+Math.sin(g)*P,t.lineTo(z,N),g+=D;else t.moveTo(Math.floor(e.x),Math.floor(e.y)),t.lineTo(Math.floor(e.wobbleX),Math.floor(u)),t.lineTo(Math.floor(h),Math.floor(p)),t.lineTo(Math.floor(c),Math.floor(e.wobbleY));return t.closePath(),t.fill(),e.tick<e.totalTicks}function pe(t,e,i,c,u){var h=e.slice(),p=t.getContext("2d"),l,f,b=S(function(j){function M(){l=f=null,p.clearRect(0,0,c.width,c.height),T.clear(),u(),j()}function F(){s&&!(c.width===m.width&&c.height===m.height)&&(c.width=t.width=m.width,c.height=t.height=m.height),!c.width&&!c.height&&(i(t),c.width=t.width,c.height=t.height),p.clearRect(0,0,c.width,c.height),h=h.filter(function(C){return he(p,C)}),h.length?l=A.frame(F):M()}l=A.frame(F),f=M});return{addFettis:function(j){return h=h.concat(j),b},canvas:t,promise:b,reset:function(){l&&A.cancel(l),f&&f()}}}function W(t,e){var i=!t,c=!!v(e||{},"resize"),u=!1,h=v(e,"disableForReducedMotion",Boolean),p=d&&!!v(e||{},"useWorker"),l=p?G():null,f=i?be:L,b=t&&l?!!t.__confetti_initialized:!1,j=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,M;function F(g,P,E){for(var z=v(g,"particleCount",_),N=v(g,"angle",Number),V=v(g,"spread",Number),D=v(g,"startVelocity",Number),Ee=v(g,"decay",Number),ze=v(g,"gravity",Number),ke=v(g,"drift",Number),ye=v(g,"colors",te),De=v(g,"ticks",Number),we=v(g,"shapes"),Oe=v(g,"scalar"),Le=!!v(g,"flat"),Se=K(g),Me=z,ge=[],We=t.width*Se.x,Ne=t.height*Se.y;Me--;)ge.push(ue({x:We,y:Ne,angle:N,spread:V,startVelocity:D,color:ye[Me%ye.length],shape:we[J(0,we.length)],ticks:De,decay:Ee,gravity:ze,drift:ke,scalar:Oe,flat:Le}));return M?M.addFettis(ge):(M=pe(t,ge,f,P,E),M.promise)}function C(g){var P=h||v(g,"disableForReducedMotion",Boolean),E=v(g,"zIndex",Number);if(P&&j)return S(function(D){D()});i&&M?t=M.canvas:i&&!t&&(t=ce(E),document.body.appendChild(t)),c&&!b&&f(t);var z={width:t.width,height:t.height};l&&!b&&l.init(t),b=!0,l&&(t.__confetti_initialized=!0);function N(){if(l){var D={getBoundingClientRect:function(){if(!i)return t.getBoundingClientRect()}};f(D),l.postMessage({resize:{width:D.width,height:D.height}});return}z.width=z.height=null}function V(){M=null,c&&(u=!1,n.removeEventListener("resize",N)),i&&t&&(document.body.contains(t)&&document.body.removeChild(t),t=null,b=!1)}return c&&!u&&(u=!0,n.addEventListener("resize",N,!1)),l?l.fire(g,z,V):F(g,z,V)}return C.reset=function(){l&&l.reset(),M&&M.reset()},C}var Q;function U(){return Q||(Q=W(null,{useWorker:!0,resize:!0})),Q}function re(t,e,i,c,u,h,p){var l=new Path2D(t),f=new Path2D;f.addPath(l,new DOMMatrix(e));var b=new Path2D;return b.addPath(f,new DOMMatrix([Math.cos(p)*u,Math.sin(p)*u,-Math.sin(p)*h,Math.cos(p)*h,i,c])),b}function fe(t){if(!x)throw new Error("path confetti are not supported in this browser");var e,i;typeof t=="string"?e=t:(e=t.path,i=t.matrix);var c=new Path2D(e),u=document.createElement("canvas"),h=u.getContext("2d");if(!i){for(var p=1e3,l=p,f=p,b=0,j=0,M,F,C=0;C<p;C+=2)for(var g=0;g<p;g+=2)h.isPointInPath(c,C,g,"nonzero")&&(l=Math.min(l,C),f=Math.min(f,g),b=Math.max(b,C),j=Math.max(j,g));M=b-l,F=j-f;var P=10,E=Math.min(P/M,P/F);i=[E,0,0,E,-Math.round(M/2+l)*E,-Math.round(F/2+f)*E]}return{type:"path",path:e,matrix:i}}function ee(t){var e,i=1,c="#000000",u='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof t=="string"?e=t:(e=t.text,i="scalar"in t?t.scalar:i,u="fontFamily"in t?t.fontFamily:u,c="color"in t?t.color:c);var h=10*i,p=""+h+"px "+u,l=new OffscreenCanvas(h,h),f=l.getContext("2d");f.font=p;var b=f.measureText(e),j=Math.ceil(b.actualBoundingBoxRight+b.actualBoundingBoxLeft),M=Math.ceil(b.actualBoundingBoxAscent+b.actualBoundingBoxDescent),F=2,C=b.actualBoundingBoxLeft+F,g=b.actualBoundingBoxAscent+F;j+=F+F,M+=F+F,l=new OffscreenCanvas(j,M),f=l.getContext("2d"),f.font=p,f.fillStyle=c,f.fillText(e,C,g);var P=1/i;return{type:"bitmap",bitmap:l.transferToImageBitmap(),matrix:[P,0,0,P,-j*P/2,-M*P/2]}}o.exports=function(){return U().apply(this,arguments)},o.exports.reset=function(){U().reset()},o.exports.create=W,o.exports.shapeFromPath=fe,o.exports.shapeFromText=ee})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),ve,!1);const oe=ve.exports;ve.exports.create;const xe=O(B),ae=O(I),ft=({item:a,showResult:n,timingAccuracy:o,xpGained:s})=>(R.useEffect(()=>{if(n){let m=["#FF6B6B","#4ECDC4","#FFE66D","#95E1D3","#F38BA8"],d=50,x=3e3;o==="perfect"?(m=["#FFD700","#FFA500","#FF69B4","#9370DB","#00CED1"],d=100,x=5e3):o==="good"&&(m=["#32CD32","#00FF7F","#ADFF2F","#98FB98"],d=75,x=4e3);const y=Date.now()+x,w=setInterval(()=>{if(Date.now()>y){clearInterval(w);return}oe({particleCount:d,angle:60,spread:55,origin:{x:0,y:.8},colors:m}),oe({particleCount:d,angle:120,spread:55,origin:{x:1,y:.8},colors:m})},o==="perfect"?50:100);return setTimeout(()=>{oe({particleCount:o==="perfect"?200:d*2,angle:90,spread:80,origin:{x:.5,y:.6},colors:m})},500),()=>clearInterval(w)}},[n,o]),n?r.jsxs(B,{position:"relative",w:"full",display:"flex",justifyContent:"center",children:[r.jsx(B,{position:"absolute",top:"-50px",left:"-50px",w:"400px",h:"400px",bg:"radial-gradient(circle, rgba(255, 230, 109, 0.3) 0%, transparent 70%)",borderRadius:"full",pointerEvents:"none",as:xe,animate:{scale:[1,1.5,1],opacity:[.6,0,.6]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}}),r.jsx(xe,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",stiffness:260,damping:20,duration:.8},position:"relative",zIndex:2,children:r.jsxs(k,{gap:6,children:[r.jsx(ae,{fontSize:"4xl",animate:{scale:[1,1.2,1],rotate:[0,10,-10,0]},transition:{duration:.6,repeat:1/0,repeatDelay:2},children:"🎉"}),o&&r.jsxs(q,{colorScheme:o==="perfect"?"yellow":o==="good"?"green":"gray",variant:"solid",px:4,py:2,fontSize:"md",borderRadius:"full",boxShadow:"0 4px 12px rgba(255, 230, 109, 0.4)",children:[o==="perfect"&&"🏆 완벽한 타이밍!",o==="good"&&"👍 좋은 타이밍!",o==="miss"&&"😅 아쉬운 타이밍"]}),r.jsx(q,{colorScheme:"purple",variant:"solid",px:4,py:2,fontSize:"md",borderRadius:"full",boxShadow:"0 4px 12px rgba(128, 90, 213, 0.4)",children:"🎯 결과"}),r.jsxs(xe,{bg:"white",p:8,borderRadius:"2xl",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.1)",border:"4px solid #FFE66D",position:"relative",whileHover:{scale:1.05},children:[r.jsx(B,{position:"absolute",top:0,left:0,right:0,bottom:0,bg:"linear-gradient(135deg, rgba(255, 107, 107, 0.05) 0%, rgba(78, 205, 196, 0.05) 100%)",borderRadius:"xl"}),r.jsx(ae,{fontSize:{base:"xl",md:"2xl"},fontWeight:"bold",color:"#2D3748",textAlign:"center",position:"relative",zIndex:1,children:a.text}),r.jsx(B,{position:"absolute",top:"-10px",right:"-10px",w:"30px",h:"30px",bg:"#FFE66D",borderRadius:"full",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 8px rgba(255, 230, 109, 0.3)",children:r.jsx(I,{fontSize:"lg",children:"✨"})})]}),s&&r.jsxs(ae,{fontSize:"lg",fontWeight:"bold",color:o==="perfect"?"#FFD700":"#4ECDC4",textAlign:"center",initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:.3,type:"spring"},children:["+",s," XP 획득! 💎"]}),r.jsx(ae,{fontSize:"lg",fontWeight:"medium",color:"#4ECDC4",textAlign:"center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:"선택되었습니다! 🎊"})]})})]}):null),gt=({onRetry:a,onGoHome:n})=>r.jsxs(Ye,{gap:6,mt:8,children:[r.jsx(se,{size:"lg",colorScheme:"orange",leftIcon:r.jsx(it,{}),onClick:a,px:8,py:6,borderRadius:"full",children:"다시 뽑기"}),r.jsx(se,{size:"lg",colorScheme:"teal",variant:"outline",leftIcon:r.jsx(st,{}),onClick:n,px:8,py:6,borderRadius:"full",borderWidth:"2px",children:"처음으로"})]}),ne=O(B),Ce=O(I),xt=({newAchievements:a,leveledUp:n,newLevel:o,onComplete:s})=>{const m=Je();return R.useEffect(()=>{if(a.length>0||n){oe({particleCount:n?150:100,angle:90,spread:80,origin:{x:.5,y:.4},colors:n?["#FFD700","#FFA500","#FF69B4","#9370DB"]:["#FF6B6B","#4ECDC4","#FFE66D","#95E1D3"]}),n&&o&&m({title:"🎉 레벨업!",description:`레벨 ${o} 달성! 새로운 테마가 해제되었습니다.`,status:"success",duration:4e3,isClosable:!0}),a.forEach(y=>{m({title:`🏆 업적 달성: ${y.name}`,description:`${y.description} (+${y.xpReward} XP)`,status:"success",duration:5e3,isClosable:!0})});const x=setTimeout(s,3e3);return()=>clearTimeout(x)}},[a,n,o,m,s]),a.length===0&&!n?null:r.jsx(Ve,{children:r.jsxs(ne,{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:1e3,initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},transition:{type:"spring",stiffness:300,damping:30},children:[r.jsxs(k,{spacing:4,bg:"white",p:8,borderRadius:"2xl",boxShadow:"0 20px 40px rgba(0,0,0,0.3)",border:"3px solid #FFD700",textAlign:"center",minW:"300px",children:[n&&o&&r.jsx(ne,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},children:r.jsxs(k,{spacing:2,children:[r.jsx(Ce,{fontSize:"3xl",animate:{scale:[1,1.2,1],rotate:[0,5,-5,0]},transition:{duration:.6,repeat:2},children:"🎊"}),r.jsxs(q,{colorScheme:"yellow",fontSize:"xl",px:6,py:2,borderRadius:"full",textTransform:"none",children:["레벨 ",o," 달성!"]}),r.jsx(I,{fontSize:"sm",color:"gray.600",children:"새로운 테마와 효과가 해제되었습니다!"})]})}),a.map((d,x)=>r.jsx(ne,{initial:{x:-50,opacity:0},animate:{x:0,opacity:1},transition:{delay:n?.5+x*.2:x*.2},children:r.jsxs(k,{spacing:2,p:4,bg:"purple.50",borderRadius:"lg",border:"2px solid",borderColor:"purple.200",children:[r.jsx(I,{fontSize:"2xl",children:d.icon}),r.jsx(I,{fontSize:"lg",fontWeight:"bold",color:"purple.700",children:d.name}),r.jsx(I,{fontSize:"sm",color:"gray.600",children:d.description}),r.jsxs(q,{colorScheme:"purple",borderRadius:"full",children:["+",d.xpReward," XP"]})]})},d.id)),r.jsx(Ce,{fontSize:"xs",color:"gray.500",initial:{opacity:0},animate:{opacity:1},transition:{delay:2},children:"3초 후 자동으로 닫힙니다..."})]}),r.jsx(ne,{position:"absolute",top:"-10px",left:"-10px",right:"-10px",bottom:"-10px",borderRadius:"3xl",bg:"linear-gradient(45deg, #FFD700, #FFA500, #FFD700, #FFA500)",opacity:.3,zIndex:-1,animate:{rotate:360},transition:{duration:3,repeat:1/0,ease:"linear"}})]})})},ie="doldol-game-stats",me={level:1,xp:0,totalGachas:0,perfectTimings:0,achievements:[],unlockedThemes:["default"]},mt=[{id:"first_gacha",name:"첫 뽑기",description:"첫 번째 가챠를 완료했습니다",icon:"🎯",condition:a=>a.totalGachas>=1,xpReward:10},{id:"perfect_timing",name:"완벽한 타이밍",description:"완벽한 타이밍으로 가챠를 멈췄습니다",icon:"⏰",condition:a=>a.perfectTimings>=1,xpReward:20},{id:"gacha_master",name:"가챠 마스터",description:"10번의 가챠를 완료했습니다",icon:"🏆",condition:a=>a.totalGachas>=10,xpReward:50},{id:"timing_expert",name:"타이밍 전문가",description:"5번의 완벽한 타이밍을 달성했습니다",icon:"🎖️",condition:a=>a.perfectTimings>=5,xpReward:100},{id:"veteran",name:"베테랑",description:"50번의 가챠를 완료했습니다",icon:"👑",condition:a=>a.totalGachas>=50,xpReward:200}],Ie=a=>Math.floor(a/100)+1,vt=a=>a&&typeof a=="object"&&typeof a.level=="number"&&typeof a.xp=="number"&&typeof a.totalGachas=="number"&&typeof a.perfectTimings=="number"&&Array.isArray(a.achievements)&&Array.isArray(a.unlockedThemes)&&a.level>=1&&a.level<=1e3&&a.xp>=0&&a.totalGachas>=0&&a.perfectTimings>=0,bt=()=>{try{const a=localStorage.getItem(ie);if(!a)return{...me};const n=JSON.parse(a);return vt(n)?n:(console.warn("Invalid game stats detected, resetting to default"),localStorage.removeItem(ie),{...me})}catch(a){return console.error("Failed to load game stats:",a),localStorage.removeItem(ie),{...me}}},yt=a=>{try{localStorage.setItem(ie,JSON.stringify(a))}catch(n){console.error("Failed to save game stats:",n)}},wt=(a,n)=>{const o=a.level,s=a.xp+n,m=Ie(s),d={...a,xp:s,level:m},x=mt.filter(y=>!a.achievements.includes(y.id)&&y.condition(d));if(x.length>0){const y=x.reduce((w,S)=>w+S.xpReward,0);d.xp+=y,d.level=Ie(d.xp),d.achievements=[...a.achievements,...x.map(w=>w.id)],x.some(w=>w.id==="timing_expert")&&(d.unlockedThemes=[...d.unlockedThemes,"golden"]),x.some(w=>w.id==="veteran")&&(d.unlockedThemes=[...d.unlockedThemes,"rainbow"])}return{newStats:d,leveledUp:m>o,newAchievements:x}},St=(a,n)=>{let o=10;n==="perfect"?o+=15:n==="good"&&(o+=5);const s={...a,totalGachas:a.totalGachas+1,perfectTimings:n==="perfect"?a.perfectTimings+1:a.perfectTimings};return wt(s,o)},Ft=()=>{const a=Xe(),n=Ue(),[o,s]=R.useState("ready"),[m,d]=R.useState(null),[x,y]=R.useState(!1),[w,S]=R.useState("miss"),[T,A]=R.useState(0),[G,Z]=R.useState({isActive:!1,startTime:0,targetZoneStart:1500,targetZoneEnd:2500}),[X,Y]=R.useState(bt()),[v,_]=R.useState([]),[J,$]=R.useState(!1),[te,H]=R.useState(),K="#F7F7F7",L=a.state?.items||[];R.useEffect(()=>{if(L.length<2){n("/");return}},[L.length,n]);const ce=()=>{s("animating"),y(!1),d(null);const W=Date.now();Z({isActive:!0,startTime:W,targetZoneStart:1500,targetZoneEnd:2500}),setTimeout(()=>{s("timing")},500)},de=W=>{S(W),Z(t=>({...t,isActive:!1})),s("result");const Q=qe(L);d(Q);const{newStats:U,leveledUp:re,newAchievements:fe}=St(X,W);Y(U),yt(U);let ee=10;W==="perfect"?ee+=15:W==="good"&&(ee+=5),A(ee),_(fe),$(re),H(re?U.level:void 0),setTimeout(()=>{y(!0)},1e3)},ue=()=>{s("ready"),y(!1),d(null),S("miss"),A(0),_([]),$(!1),H(void 0)},he=()=>{n("/")},pe=()=>{_([]),$(!1),H(void 0)};return L.length<2?null:r.jsxs(B,{bg:K,minH:"100vh",py:8,position:"relative",children:[r.jsx(Ke,{maxW:"4xl",h:"90vh",children:r.jsxs(k,{spacing:8,align:"center",justify:"center",h:"full",children:[o==="ready"&&r.jsx(dt,{onStart:ce,gameStats:X,itemCount:L.length}),o==="animating"&&r.jsxs(r.Fragment,{children:[r.jsx(I,{fontSize:"2xl",fontWeight:"bold",color:"#FF6B6B",textAlign:"center",children:"🎯 가챠 애니메이션 시작!"}),r.jsx(Fe,{items:L})]}),o==="timing"&&r.jsxs(r.Fragment,{children:[r.jsx(I,{fontSize:"xl",fontWeight:"bold",color:"#FF6B6B",textAlign:"center",children:"⚡ 지금이야! 타이밍을 맞춰보세요!"}),r.jsx(Fe,{items:L}),r.jsx(pt,{timingGame:G,onStop:de,animationDuration:3e3})]}),o==="result"&&r.jsxs(r.Fragment,{children:[m&&r.jsx(ft,{item:m,showResult:x,timingAccuracy:w,xpGained:T}),x&&r.jsx(gt,{onRetry:ue,onGoHome:he})]})]})}),r.jsx(xt,{newAchievements:v,leveledUp:J,newLevel:te,onComplete:pe})]})};export{Ft as default};
