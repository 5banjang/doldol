import{F as ce,f as Ie,o as Ne,d as _e,j as a,h as ze,g as $e,R as He,G as Xe,B as z,s as W,r as I,A as Ve,H as Ue,D as qe,z as Ye,J as Je}from"./index-DHyWCPZO.js";import{c as Re,V as D,T as P,e as K,B as le,H as Ge,u as Ke,C as Qe}from"./text-BDYVUkcd.js";function et(r,n,o){return(r-n)*100/(o-n)}ce({"0%":{strokeDasharray:"1, 400",strokeDashoffset:"0"},"50%":{strokeDasharray:"400, 400",strokeDashoffset:"-100"},"100%":{strokeDasharray:"400, 400",strokeDashoffset:"-260"}});ce({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}});const tt=ce({"0%":{left:"-40%"},"100%":{left:"100%"}}),rt=ce({from:{backgroundPosition:"1rem 0"},to:{backgroundPosition:"0 0"}});function at(r){const{value:n=0,min:o,max:s,valueText:u,getValueText:d,isIndeterminate:x,role:w="progressbar"}=r,v=et(n,o,s);return{bind:{"data-indeterminate":x?"":void 0,"aria-valuemax":s,"aria-valuemin":o,"aria-valuenow":x?void 0:n,"aria-valuetext":(()=>{if(n!=null)return typeof d=="function"?d(n,v):u})(),role:w},percent:v,value:n}}const[nt,ot]=$e({name:"ProgressStylesContext",errorMessage:`useProgressStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Progress />" `}),st=Ie((r,n)=>{const{min:o,max:s,value:u,isIndeterminate:d,role:x,...w}=r,v=at({value:u,min:o,max:s,isIndeterminate:d,role:x}),T={height:"100%",...ot().filledTrack};return a.jsx(ze.div,{ref:n,style:{width:`${v.percent}%`,...w.style},...v.bind,...w,__css:T})}),Be=Ie((r,n)=>{const{value:o,min:s=0,max:u=100,hasStripe:d,isAnimated:x,children:w,borderRadius:v,isIndeterminate:b,"aria-label":T,"aria-labelledby":B,"aria-valuetext":E,title:$,role:U,...L}=Ne(r),y=_e("Progress",r),q=v??y.track?.borderRadius,H={animation:`${rt} 1s linear infinite`},Q={...!b&&d&&x&&H,...b&&{position:"absolute",willChange:"left",minWidth:"50%",animation:`${tt} 1s ease infinite normal none running`}},X={overflow:"hidden",position:"relative",...y.track};return a.jsx(ze.div,{ref:n,borderRadius:q,__css:X,...L,children:a.jsxs(nt,{value:y,children:[a.jsx(st,{"aria-label":T,"aria-labelledby":B,"aria-valuetext":E,min:s,max:u,value:o,isIndeterminate:b,css:Q,borderRadius:q,title:$,role:U}),w]})})});Be.displayName="Progress";const it=Re({displayName:"RepeatIcon",path:a.jsxs("g",{fill:"currentColor",children:[a.jsx("path",{d:"M10.319,4.936a7.239,7.239,0,0,1,7.1,2.252,1.25,1.25,0,1,0,1.872-1.657A9.737,9.737,0,0,0,9.743,2.5,10.269,10.269,0,0,0,2.378,9.61a.249.249,0,0,1-.271.178l-1.033-.13A.491.491,0,0,0,.6,9.877a.5.5,0,0,0-.019.526l2.476,4.342a.5.5,0,0,0,.373.248.43.43,0,0,0,.062,0,.5.5,0,0,0,.359-.152l3.477-3.593a.5.5,0,0,0-.3-.844L5.15,10.172a.25.25,0,0,1-.2-.333A7.7,7.7,0,0,1,10.319,4.936Z"}),a.jsx("path",{d:"M23.406,14.1a.5.5,0,0,0,.015-.526l-2.5-4.329A.5.5,0,0,0,20.546,9a.489.489,0,0,0-.421.151l-3.456,3.614a.5.5,0,0,0,.3.842l1.848.221a.249.249,0,0,1,.183.117.253.253,0,0,1,.023.216,7.688,7.688,0,0,1-5.369,4.9,7.243,7.243,0,0,1-7.1-2.253,1.25,1.25,0,1,0-1.872,1.656,9.74,9.74,0,0,0,9.549,3.03,10.261,10.261,0,0,0,7.369-7.12.251.251,0,0,1,.27-.179l1.058.127a.422.422,0,0,0,.06,0A.5.5,0,0,0,23.406,14.1Z"})]})}),lt=Re({d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z",displayName:"ArrowBackIcon"}),ct=W(z),je=W(P),Fe=({items:r})=>{const n=He.useMemo(()=>{const o=[];for(let s=0;s<10;s++)o.push(...Xe(r));return o.slice(0,20)},[r]);return a.jsxs(z,{position:"relative",w:{base:"90vw",md:"400px",lg:"500px"},maxW:"90vw",h:{base:"200px",md:"250px",lg:"300px"},display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",bg:"linear-gradient(135deg, #FF6B6B 0%, #4ECDC4 100%)",borderRadius:"xl",boxShadow:"xl",children:[a.jsx(ct,{position:"absolute",top:0,left:0,right:0,bottom:0,bg:"radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%)",animate:{scale:[1,1.2,1],rotate:[0,180,360]},transition:{duration:3,repeat:1/0,ease:"linear"}}),a.jsxs(z,{position:"relative",w:{base:"80%",md:"300px"},h:{base:"70%",md:"200px"},bg:"white",borderRadius:"lg",border:"4px solid white",boxShadow:"inset 0 0 20px rgba(0,0,0,0.1)",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center",children:[a.jsx(D,{gap:2,position:"absolute",w:"full",children:n.slice(0,5).map((o,s)=>a.jsx(je,{fontSize:{base:"md",md:"lg"},fontWeight:"bold",color:"#2D3748",textAlign:"center",px:4,py:2,w:"full",initial:{y:-100,opacity:0},animate:{y:[0,100],opacity:[1,0]},transition:{duration:.6,delay:s*.1,repeat:1/0,repeatDelay:2},children:o.text},`${o.id}-${s}`))}),a.jsx(z,{position:"absolute",top:"45%",left:0,right:0,h:"2px",bg:"#FF6B6B",zIndex:2}),a.jsx(z,{position:"absolute",top:"55%",left:0,right:0,h:"2px",bg:"#FF6B6B",zIndex:2})]}),a.jsx(je,{position:"absolute",bottom:"20px",fontSize:"sm",color:"white",fontWeight:"medium",animate:{opacity:[.7,1,.7]},transition:{duration:1,repeat:1/0},children:"뽑는 중..."})]})},dt=W(le),Te=W(z),ut=({onStart:r,gameStats:n,itemCount:o})=>a.jsxs(D,{spacing:6,children:[a.jsx(Te,{initial:{scale:0},animate:{scale:1},transition:{delay:.3,type:"spring"},children:a.jsxs(K,{colorScheme:"purple",fontSize:"lg",px:4,py:2,borderRadius:"full",textAlign:"center",children:["🏆 레벨 ",n.level," (XP: ",n.xp,")"]})}),a.jsxs(D,{spacing:2,children:[a.jsx(P,{fontSize:"xl",fontWeight:"bold",color:"#FF6B6B",textAlign:"center",children:"🎯 가챠 준비 완료!"}),a.jsxs(P,{fontSize:"md",color:"gray.600",textAlign:"center",children:[o,"개의 항목에서 하나를 뽑아보세요"]}),a.jsx(P,{fontSize:"sm",color:"gray.500",textAlign:"center",children:"💡 타이밍을 맞춰서 더 많은 XP를 획득하세요!"})]}),a.jsx(dt,{size:"xl",colorScheme:"red",onClick:r,px:12,py:8,fontSize:"2xl",fontWeight:"bold",borderRadius:"full",boxShadow:"0 8px 25px rgba(255, 107, 107, 0.4)",_hover:{transform:"translateY(-3px)",boxShadow:"0 12px 30px rgba(255, 107, 107, 0.5)"},_active:{transform:"translateY(-1px)"},initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{delay:.6,type:"spring",stiffness:260,damping:20},whileHover:{scale:1.05},whileTap:{scale:.95},children:"🎲 뽑기 시작!"}),a.jsx(Te,{position:"absolute",w:"200px",h:"80px",borderRadius:"full",border:"3px solid #FF6B6B",opacity:.3,zIndex:-1,animate:{scale:[1,1.3,1],opacity:[.3,0,.3]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}}),a.jsxs(D,{spacing:1,pt:4,children:[a.jsxs(P,{fontSize:"xs",color:"gray.500",children:["총 가챠: ",n.totalGachas,"회 | 완벽 타이밍: ",n.perfectTimings,"회"]}),n.achievements.length>0&&a.jsxs(P,{fontSize:"xs",color:"purple.500",children:["🏅 달성 업적: ",n.achievements.length,"개"]})]})]}),ft=(r,n)=>{if(n!=="auto")return n;const{consecutiveSuccess:o,consecutiveFails:s}=r;return s>=3?"easy":o>=10?"expert":o>=6?"hard":o>=3?"normal":"easy"},pt=r=>({easy:{perfectZoneSize:20,goodZoneSize:35,zonePosition:Math.random()*40+30,animationSpeed:1.2},normal:{perfectZoneSize:10,goodZoneSize:25,zonePosition:Math.random()*60+20,animationSpeed:1},hard:{perfectZoneSize:6,goodZoneSize:18,zonePosition:Math.random()*70+15,animationSpeed:.8},expert:{perfectZoneSize:4,goodZoneSize:12,zonePosition:Math.random()*80+10,animationSpeed:.7}})[r],ht=(r,n,o="auto")=>{const s=ft(n,o),u=pt(s),d=r*u.animationSpeed,x=d*u.perfectZoneSize/100,w=d*u.zonePosition/100,v=w-x/2,b=w+x/2;return{isActive:!0,startTime:Date.now(),targetZoneStart:v,targetZoneEnd:b,targetZonePosition:u.zonePosition,difficulty:s,accuracy:void 0}},gt=(r,n,o)=>{const s={perfect:25,good:10,miss:0},u={easy:1,normal:1.2,hard:1.5,expert:2},d=Math.min(o*2,20),x=u[n]||1;return Math.floor(s[r]*x+(r==="perfect"?d:0))},xt=(r,n,o)=>{const s={...r};s.totalGachas++,s.xp+=o,n==="perfect"?(s.perfectTimings++,s.consecutiveSuccess++,s.consecutiveFails=0):n==="good"?(s.consecutiveSuccess++,s.consecutiveFails=0):(s.consecutiveSuccess=0,s.consecutiveFails++);const u=s.level*100+100;return s.xp>=u&&(s.level++,s.xp-=u),s},mt=r=>{if(!navigator.vibrate)return;const n={perfect:[100,50,100],good:[100],miss:[50,50,50]};navigator.vibrate(n[r])},vt=W(le),bt=W(z),yt=({timingGame:r,onStop:n,animationDuration:o})=>{const[s,u]=I.useState(0),[d,x]=I.useState(o);I.useEffect(()=>{if(!r.isActive)return;const b=Date.now(),T=setInterval(()=>{const B=Date.now()-b,E=B/o*100,$=Math.max(0,o-B);u(Math.min(100,E)),x($),B>=o&&(clearInterval(T),n("miss"))},16);return()=>clearInterval(T)},[r.isActive,o,n]);const w=()=>{const b=Date.now()-r.startTime;let T;const E=(r.targetZoneEnd-r.targetZoneStart)*.8;b>=r.targetZoneStart&&b<=r.targetZoneEnd?T="perfect":b>=r.targetZoneStart-E&&b<r.targetZoneStart||b>r.targetZoneEnd&&b<=r.targetZoneEnd+E?T="good":T="miss",mt(T),n(T)},v=()=>{const b=r.targetZoneStart/o*100,T=r.targetZoneEnd/o*100;return s>=b&&s<=T?"green.400":"yellow.400"};return r.isActive?a.jsxs(D,{spacing:4,w:{base:"90vw",md:"400px"},maxW:"90vw",children:[a.jsxs(z,{w:"full",position:"relative",children:[a.jsx(Be,{value:s,size:"lg",colorScheme:s>=50&&s<=83?"green":"red",bg:"gray.200",borderRadius:"full",height:"20px"}),a.jsx(z,{position:"absolute",top:"0",left:`${r.targetZonePosition-(r.targetZoneEnd-r.targetZoneStart)/o*50}%`,width:`${(r.targetZoneEnd-r.targetZoneStart)/o*100}%`,height:"20px",bg:r.difficulty==="expert"?"red.200":r.difficulty==="hard"?"orange.200":"green.200",borderRadius:"full",border:"2px solid",borderColor:r.difficulty==="expert"?"red.400":r.difficulty==="hard"?"orange.400":"green.400",opacity:.8}),a.jsx(bt,{position:"absolute",top:"-5px",left:`${s}%`,transform:"translateX(-50%)",w:"10px",h:"30px",bg:v(),borderRadius:"full",border:"2px solid white",boxShadow:"0 2px 8px rgba(0,0,0,0.3)",animate:{scale:[1,1.2,1]},transition:{duration:.5,repeat:1/0}})]}),a.jsxs(D,{spacing:2,children:[a.jsx(K,{colorScheme:s>=r.targetZoneStart/o*100&&s<=r.targetZoneEnd/o*100?"green":r.difficulty==="expert"?"red":r.difficulty==="hard"?"orange":"yellow",fontSize:"md",px:3,py:1,borderRadius:"full",children:s>=r.targetZoneStart/o*100&&s<=r.targetZoneEnd/o*100?"🎯 완벽 존!":`⚡ ${r.difficulty.toUpperCase()} 모드`}),a.jsxs(P,{fontSize:"sm",color:"gray.600",children:["남은 시간: ",(d/1e3).toFixed(1),"초"]})]}),a.jsx(vt,{size:{base:"lg",md:"xl"},colorScheme:s>=50&&s<=83?"green":"orange",onClick:w,px:{base:8,md:10},py:{base:4,md:6},fontSize:{base:"lg",md:"xl"},fontWeight:"bold",borderRadius:"full",boxShadow:"0 6px 20px rgba(0,0,0,0.2)",minH:{base:"60px",md:"auto"},_hover:{transform:"translateY(-2px)",boxShadow:"0 8px 25px rgba(0,0,0,0.3)"},_active:{transform:"translateY(0)"},animate:{scale:s>=50&&s<=83?[1,1.1,1]:1,boxShadow:s>=50&&s<=83?["0 6px 20px rgba(0,0,0,0.2)","0 8px 30px rgba(34, 197, 94, 0.4)","0 6px 20px rgba(0,0,0,0.2)"]:"0 6px 20px rgba(0,0,0,0.2)"},transition:{duration:.3,repeat:s>=50&&s<=83?1/0:0},whileHover:{scale:1.05},whileTap:{scale:.95},children:"⏹️ 스톱!"}),a.jsx(P,{fontSize:"xs",color:"gray.500",textAlign:"center",children:r.difficulty==="expert"?"🔥 전문가 모드: +50 XP":r.difficulty==="hard"?"💪 어려움 모드: +37 XP":r.difficulty==="normal"?"⚡ 보통 모드: +30 XP":"🌟 쉬움 모드: +25 XP"})]}):null};var ve={};(function r(n,o,s,u){var d=!!(n.Worker&&n.Blob&&n.Promise&&n.OffscreenCanvas&&n.OffscreenCanvasRenderingContext2D&&n.HTMLCanvasElement&&n.HTMLCanvasElement.prototype.transferControlToOffscreen&&n.URL&&n.URL.createObjectURL),x=typeof Path2D=="function"&&typeof DOMMatrix=="function",w=function(){if(!n.OffscreenCanvas)return!1;var t=new OffscreenCanvas(1,1),e=t.getContext("2d");e.fillRect(0,0,1,1);var i=t.transferToImageBitmap();try{e.createPattern(i,"no-repeat")}catch{return!1}return!0}();function v(){}function b(t){var e=o.exports.Promise,i=e!==void 0?e:n.Promise;return typeof i=="function"?new i(t):(t(v,v),null)}var T=function(t,e){return{transform:function(i){if(t)return i;if(e.has(i))return e.get(i);var c=new OffscreenCanvas(i.width,i.height),f=c.getContext("2d");return f.drawImage(i,0,0),e.set(i,c),c},clear:function(){e.clear()}}}(w,new Map),B=function(){var t=Math.floor(16.666666666666668),e,i,c={},f=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(e=function(p){var h=Math.random();return c[h]=requestAnimationFrame(function l(g){f===g||f+t-1<g?(f=g,delete c[h],p()):c[h]=requestAnimationFrame(l)}),h},i=function(p){c[p]&&cancelAnimationFrame(c[p])}):(e=function(p){return setTimeout(p,t)},i=function(p){return clearTimeout(p)}),{frame:e,cancel:i}}(),E=function(){var t,e,i={};function c(f){function p(h,l){f.postMessage({options:h||{},callback:l})}f.init=function(l){var g=l.transferControlToOffscreen();f.postMessage({canvas:g},[g])},f.fire=function(l,g,S){if(e)return p(l,null),e;var j=Math.random().toString(36).slice(2);return e=b(function(M){function F(C){C.data.callback===j&&(delete i[j],f.removeEventListener("message",F),e=null,T.clear(),S(),M())}f.addEventListener("message",F),p(l,j),i[j]=F.bind(null,{data:{callback:j}})}),e},f.reset=function(){f.postMessage({reset:!0});for(var l in i)i[l](),delete i[l]}}return function(){if(t)return t;if(!s&&d){var f=["var CONFETTI, SIZE = {}, module = {};","("+r.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{t=new Worker(URL.createObjectURL(new Blob([f])))}catch(p){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("🎊 Could not load worker",p),null}c(t)}return t}}(),$={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function U(t,e){return e?e(t):t}function L(t){return t!=null}function y(t,e,i){return U(t&&L(t[e])?t[e]:$[e],i)}function q(t){return t<0?0:Math.floor(t)}function H(t,e){return Math.floor(Math.random()*(e-t))+t}function Y(t){return parseInt(t,16)}function J(t){return t.map(Q)}function Q(t){var e=String(t).replace(/[^0-9a-f]/gi,"");return e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),{r:Y(e.substring(0,2)),g:Y(e.substring(2,4)),b:Y(e.substring(4,6))}}function X(t){var e=y(t,"origin",Object);return e.x=y(e,"x",Number),e.y=y(e,"y",Number),e}function de(t){t.width=document.documentElement.clientWidth,t.height=document.documentElement.clientHeight}function be(t){var e=t.getBoundingClientRect();t.width=e.width,t.height=e.height}function N(t){var e=document.createElement("canvas");return e.style.position="fixed",e.style.top="0px",e.style.left="0px",e.style.pointerEvents="none",e.style.zIndex=t,e}function ue(t,e,i,c,f,p,h,l,g){t.save(),t.translate(e,i),t.rotate(p),t.scale(c,f),t.arc(0,0,1,h,l,g),t.restore()}function fe(t){var e=t.angle*(Math.PI/180),i=t.spread*(Math.PI/180);return{x:t.x,y:t.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:t.startVelocity*.5+Math.random()*t.startVelocity,angle2D:-e+(.5*i-Math.random()*i),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:t.color,shape:t.shape,tick:0,totalTicks:t.ticks,decay:t.decay,drift:t.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:t.gravity*3,ovalScalar:.6,scalar:t.scalar,flat:t.flat}}function pe(t,e){e.x+=Math.cos(e.angle2D)*e.velocity+e.drift,e.y+=Math.sin(e.angle2D)*e.velocity+e.gravity,e.velocity*=e.decay,e.flat?(e.wobble=0,e.wobbleX=e.x+10*e.scalar,e.wobbleY=e.y+10*e.scalar,e.tiltSin=0,e.tiltCos=0,e.random=1):(e.wobble+=e.wobbleSpeed,e.wobbleX=e.x+10*e.scalar*Math.cos(e.wobble),e.wobbleY=e.y+10*e.scalar*Math.sin(e.wobble),e.tiltAngle+=.1,e.tiltSin=Math.sin(e.tiltAngle),e.tiltCos=Math.cos(e.tiltAngle),e.random=Math.random()+2);var i=e.tick++/e.totalTicks,c=e.x+e.random*e.tiltCos,f=e.y+e.random*e.tiltSin,p=e.wobbleX+e.random*e.tiltCos,h=e.wobbleY+e.random*e.tiltSin;if(t.fillStyle="rgba("+e.color.r+", "+e.color.g+", "+e.color.b+", "+(1-i)+")",t.beginPath(),x&&e.shape.type==="path"&&typeof e.shape.path=="string"&&Array.isArray(e.shape.matrix))t.fill(re(e.shape.path,e.shape.matrix,e.x,e.y,Math.abs(p-c)*.1,Math.abs(h-f)*.1,Math.PI/10*e.wobble));else if(e.shape.type==="bitmap"){var l=Math.PI/10*e.wobble,g=Math.abs(p-c)*.1,S=Math.abs(h-f)*.1,j=e.shape.bitmap.width*e.scalar,M=e.shape.bitmap.height*e.scalar,F=new DOMMatrix([Math.cos(l)*g,Math.sin(l)*g,-Math.sin(l)*S,Math.cos(l)*S,e.x,e.y]);F.multiplySelf(new DOMMatrix(e.shape.matrix));var C=t.createPattern(T.transform(e.shape.bitmap),"no-repeat");C.setTransform(F),t.globalAlpha=1-i,t.fillStyle=C,t.fillRect(e.x-j/2,e.y-M/2,j,M),t.globalAlpha=1}else if(e.shape==="circle")t.ellipse?t.ellipse(e.x,e.y,Math.abs(p-c)*e.ovalScalar,Math.abs(h-f)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI):ue(t,e.x,e.y,Math.abs(p-c)*e.ovalScalar,Math.abs(h-f)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI);else if(e.shape==="star")for(var m=Math.PI/2*3,R=4*e.scalar,k=8*e.scalar,Z=e.x,_=e.y,V=5,O=Math.PI/V;V--;)Z=e.x+Math.cos(m)*k,_=e.y+Math.sin(m)*k,t.lineTo(Z,_),m+=O,Z=e.x+Math.cos(m)*R,_=e.y+Math.sin(m)*R,t.lineTo(Z,_),m+=O;else t.moveTo(Math.floor(e.x),Math.floor(e.y)),t.lineTo(Math.floor(e.wobbleX),Math.floor(f)),t.lineTo(Math.floor(p),Math.floor(h)),t.lineTo(Math.floor(c),Math.floor(e.wobbleY));return t.closePath(),t.fill(),e.tick<e.totalTicks}function he(t,e,i,c,f){var p=e.slice(),h=t.getContext("2d"),l,g,S=b(function(j){function M(){l=g=null,h.clearRect(0,0,c.width,c.height),T.clear(),f(),j()}function F(){s&&!(c.width===u.width&&c.height===u.height)&&(c.width=t.width=u.width,c.height=t.height=u.height),!c.width&&!c.height&&(i(t),c.width=t.width,c.height=t.height),h.clearRect(0,0,c.width,c.height),p=p.filter(function(C){return pe(h,C)}),p.length?l=B.frame(F):M()}l=B.frame(F),g=M});return{addFettis:function(j){return p=p.concat(j),S},canvas:t,promise:S,reset:function(){l&&B.cancel(l),g&&g()}}}function ee(t,e){var i=!t,c=!!y(e||{},"resize"),f=!1,p=y(e,"disableForReducedMotion",Boolean),h=d&&!!y(e||{},"useWorker"),l=h?E():null,g=i?de:be,S=t&&l?!!t.__confetti_initialized:!1,j=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,M;function F(m,R,k){for(var Z=y(m,"particleCount",q),_=y(m,"angle",Number),V=y(m,"spread",Number),O=y(m,"startVelocity",Number),Ee=y(m,"decay",Number),Ae=y(m,"gravity",Number),ke=y(m,"drift",Number),ye=y(m,"colors",J),Ze=y(m,"ticks",Number),Se=y(m,"shapes"),De=y(m,"scalar"),Le=!!y(m,"flat"),we=X(m),Me=Z,ge=[],Oe=t.width*we.x,We=t.height*we.y;Me--;)ge.push(fe({x:Oe,y:We,angle:_,spread:V,startVelocity:O,color:ye[Me%ye.length],shape:Se[H(0,Se.length)],ticks:Ze,decay:Ee,gravity:Ae,drift:ke,scalar:De,flat:Le}));return M?M.addFettis(ge):(M=he(t,ge,g,R,k),M.promise)}function C(m){var R=p||y(m,"disableForReducedMotion",Boolean),k=y(m,"zIndex",Number);if(R&&j)return b(function(O){O()});i&&M?t=M.canvas:i&&!t&&(t=N(k),document.body.appendChild(t)),c&&!S&&g(t);var Z={width:t.width,height:t.height};l&&!S&&l.init(t),S=!0,l&&(t.__confetti_initialized=!0);function _(){if(l){var O={getBoundingClientRect:function(){if(!i)return t.getBoundingClientRect()}};g(O),l.postMessage({resize:{width:O.width,height:O.height}});return}Z.width=Z.height=null}function V(){M=null,c&&(f=!1,n.removeEventListener("resize",_)),i&&t&&(document.body.contains(t)&&document.body.removeChild(t),t=null,S=!1)}return c&&!f&&(f=!0,n.addEventListener("resize",_,!1)),l?l.fire(m,Z,V):F(m,Z,V)}return C.reset=function(){l&&l.reset(),M&&M.reset()},C}var A;function te(){return A||(A=ee(null,{useWorker:!0,resize:!0})),A}function re(t,e,i,c,f,p,h){var l=new Path2D(t),g=new Path2D;g.addPath(l,new DOMMatrix(e));var S=new Path2D;return S.addPath(g,new DOMMatrix([Math.cos(h)*f,Math.sin(h)*f,-Math.sin(h)*p,Math.cos(h)*p,i,c])),S}function G(t){if(!x)throw new Error("path confetti are not supported in this browser");var e,i;typeof t=="string"?e=t:(e=t.path,i=t.matrix);var c=new Path2D(e),f=document.createElement("canvas"),p=f.getContext("2d");if(!i){for(var h=1e3,l=h,g=h,S=0,j=0,M,F,C=0;C<h;C+=2)for(var m=0;m<h;m+=2)p.isPointInPath(c,C,m,"nonzero")&&(l=Math.min(l,C),g=Math.min(g,m),S=Math.max(S,C),j=Math.max(j,m));M=S-l,F=j-g;var R=10,k=Math.min(R/M,R/F);i=[k,0,0,k,-Math.round(M/2+l)*k,-Math.round(F/2+g)*k]}return{type:"path",path:e,matrix:i}}function ae(t){var e,i=1,c="#000000",f='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof t=="string"?e=t:(e=t.text,i="scalar"in t?t.scalar:i,f="fontFamily"in t?t.fontFamily:f,c="color"in t?t.color:c);var p=10*i,h=""+p+"px "+f,l=new OffscreenCanvas(p,p),g=l.getContext("2d");g.font=h;var S=g.measureText(e),j=Math.ceil(S.actualBoundingBoxRight+S.actualBoundingBoxLeft),M=Math.ceil(S.actualBoundingBoxAscent+S.actualBoundingBoxDescent),F=2,C=S.actualBoundingBoxLeft+F,m=S.actualBoundingBoxAscent+F;j+=F+F,M+=F+F,l=new OffscreenCanvas(j,M),g=l.getContext("2d"),g.font=h,g.fillStyle=c,g.fillText(e,C,m);var R=1/i;return{type:"bitmap",bitmap:l.transferToImageBitmap(),matrix:[R,0,0,R,-j*R/2,-M*R/2]}}o.exports=function(){return te().apply(this,arguments)},o.exports.reset=function(){te().reset()},o.exports.create=ee,o.exports.shapeFromPath=G,o.exports.shapeFromText=ae})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),ve,!1);const se=ve.exports;ve.exports.create;const xe=W(z),ne=W(P),St=({item:r,showResult:n,timingAccuracy:o,xpGained:s})=>(I.useEffect(()=>{if(n){let u=["#FF6B6B","#4ECDC4"],d=20;o==="perfect"?(u=["#FFD700","#FFA500"],d=30):o==="good"?(u=["#32CD32","#00FF7F"],d=25):o==="miss"&&(u=["#FFB6C1"],d=10);const x=setTimeout(()=>{se({particleCount:d,angle:90,spread:45,origin:{x:.5,y:.7},colors:u,gravity:.8,scalar:.8}),o==="perfect"&&setTimeout(()=>{se({particleCount:15,angle:60,spread:35,origin:{x:.2,y:.8},colors:u,gravity:.6,scalar:.6}),se({particleCount:15,angle:120,spread:35,origin:{x:.8,y:.8},colors:u,gravity:.6,scalar:.6})},300)},200);return()=>clearTimeout(x)}},[n,o]),n?a.jsxs(z,{position:"relative",w:"full",display:"flex",justifyContent:"center",children:[a.jsx(z,{position:"absolute",top:"-20px",left:"-20px",w:"200px",h:"200px",bg:"radial-gradient(circle, rgba(255, 230, 109, 0.15) 0%, transparent 50%)",borderRadius:"full",pointerEvents:"none",as:xe,animate:{scale:[1,1.2,1],opacity:[.3,0,.3]},transition:{duration:1.5,repeat:2,ease:"easeInOut"}}),a.jsx(xe,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",stiffness:260,damping:20,duration:.8},position:"relative",zIndex:2,children:a.jsxs(D,{gap:6,children:[a.jsx(ne,{fontSize:"2xl",animate:{scale:[1,1.1,1]},transition:{duration:.8,repeat:1},children:o==="perfect"?"🏆":o==="good"?"👍":"😊"}),o&&a.jsxs(K,{colorScheme:o==="perfect"?"yellow":o==="good"?"green":"gray",variant:"solid",px:4,py:2,fontSize:"md",borderRadius:"full",boxShadow:"0 4px 12px rgba(255, 230, 109, 0.4)",children:[o==="perfect"&&"🏆 완벽한 타이밍!",o==="good"&&"👍 좋은 타이밍!",o==="miss"&&"😅 아쉬운 타이밍"]}),a.jsx(K,{colorScheme:"purple",variant:"solid",px:4,py:2,fontSize:"md",borderRadius:"full",boxShadow:"0 4px 12px rgba(128, 90, 213, 0.4)",children:"🎯 결과"}),a.jsxs(xe,{bg:"white",p:8,borderRadius:"2xl",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.1)",border:"4px solid #FFE66D",position:"relative",whileHover:{scale:1.05},children:[a.jsx(z,{position:"absolute",top:0,left:0,right:0,bottom:0,bg:"linear-gradient(135deg, rgba(255, 107, 107, 0.05) 0%, rgba(78, 205, 196, 0.05) 100%)",borderRadius:"xl"}),a.jsx(ne,{fontSize:{base:"xl",md:"2xl"},fontWeight:"bold",color:"#2D3748",textAlign:"center",position:"relative",zIndex:1,children:r.text}),a.jsx(z,{position:"absolute",top:"-10px",right:"-10px",w:"30px",h:"30px",bg:"#FFE66D",borderRadius:"full",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 8px rgba(255, 230, 109, 0.3)",children:a.jsx(P,{fontSize:"lg",children:"✨"})})]}),s&&a.jsxs(ne,{fontSize:"lg",fontWeight:"bold",color:o==="perfect"?"#FFD700":"#4ECDC4",textAlign:"center",initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:.3,type:"spring"},children:["+",s," XP 획득! 💎"]}),a.jsx(ne,{fontSize:"lg",fontWeight:"medium",color:"#4ECDC4",textAlign:"center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:"선택되었습니다! 🎊"})]})})]}):null),wt=({onRetry:r,onGoHome:n})=>a.jsxs(Ge,{gap:6,mt:8,children:[a.jsx(le,{size:"lg",colorScheme:"orange",leftIcon:a.jsx(it,{}),onClick:r,px:8,py:6,borderRadius:"full",children:"다시 뽑기"}),a.jsx(le,{size:"lg",colorScheme:"teal",variant:"outline",leftIcon:a.jsx(lt,{}),onClick:n,px:8,py:6,borderRadius:"full",borderWidth:"2px",children:"처음으로"})]}),oe=W(z),Ce=W(P),Mt=({newAchievements:r,leveledUp:n,newLevel:o,onComplete:s})=>{const u=Ke();return I.useEffect(()=>{if(r.length>0||n){se({particleCount:n?150:100,angle:90,spread:80,origin:{x:.5,y:.4},colors:n?["#FFD700","#FFA500","#FF69B4","#9370DB"]:["#FF6B6B","#4ECDC4","#FFE66D","#95E1D3"]}),n&&o&&u({title:"🎉 레벨업!",description:`레벨 ${o} 달성! 새로운 테마가 해제되었습니다.`,status:"success",duration:4e3,isClosable:!0}),r.forEach(w=>{u({title:`🏆 업적 달성: ${w.name}`,description:`${w.description} (+${w.xpReward} XP)`,status:"success",duration:5e3,isClosable:!0})});const x=setTimeout(s,3e3);return()=>clearTimeout(x)}},[r,n,o,u,s]),r.length===0&&!n?null:a.jsx(Ve,{children:a.jsxs(oe,{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:1e3,initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},transition:{type:"spring",stiffness:300,damping:30},children:[a.jsxs(D,{spacing:4,bg:"white",p:8,borderRadius:"2xl",boxShadow:"0 20px 40px rgba(0,0,0,0.3)",border:"3px solid #FFD700",textAlign:"center",minW:"300px",children:[n&&o&&a.jsx(oe,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},children:a.jsxs(D,{spacing:2,children:[a.jsx(Ce,{fontSize:"3xl",animate:{scale:[1,1.2,1],rotate:[0,5,-5,0]},transition:{duration:.6,repeat:2},children:"🎊"}),a.jsxs(K,{colorScheme:"yellow",fontSize:"xl",px:6,py:2,borderRadius:"full",textTransform:"none",children:["레벨 ",o," 달성!"]}),a.jsx(P,{fontSize:"sm",color:"gray.600",children:"새로운 테마와 효과가 해제되었습니다!"})]})}),r.map((d,x)=>a.jsx(oe,{initial:{x:-50,opacity:0},animate:{x:0,opacity:1},transition:{delay:n?.5+x*.2:x*.2},children:a.jsxs(D,{spacing:2,p:4,bg:"purple.50",borderRadius:"lg",border:"2px solid",borderColor:"purple.200",children:[a.jsx(P,{fontSize:"2xl",children:d.icon}),a.jsx(P,{fontSize:"lg",fontWeight:"bold",color:"purple.700",children:d.name}),a.jsx(P,{fontSize:"sm",color:"gray.600",children:d.description}),a.jsxs(K,{colorScheme:"purple",borderRadius:"full",children:["+",d.xpReward," XP"]})]})},d.id)),a.jsx(Ce,{fontSize:"xs",color:"gray.500",initial:{opacity:0},animate:{opacity:1},transition:{delay:2},children:"3초 후 자동으로 닫힙니다..."})]}),a.jsx(oe,{position:"absolute",top:"-10px",left:"-10px",right:"-10px",bottom:"-10px",borderRadius:"3xl",bg:"linear-gradient(45deg, #FFD700, #FFA500, #FFD700, #FFA500)",opacity:.3,zIndex:-1,animate:{rotate:360},transition:{duration:3,repeat:1/0,ease:"linear"}})]})})},ie="doldol-game-stats",me={level:1,xp:0,totalGachas:0,perfectTimings:0,consecutiveSuccess:0,consecutiveFails:0,achievements:[],unlockedThemes:["default"]},jt=[{id:"first_gacha",name:"첫 뽑기",description:"첫 번째 가챠를 완료했습니다",icon:"🎯",condition:r=>r.totalGachas>=1,xpReward:10},{id:"perfect_timing",name:"완벽한 타이밍",description:"완벽한 타이밍으로 가챠를 멈췄습니다",icon:"⏰",condition:r=>r.perfectTimings>=1,xpReward:20},{id:"gacha_master",name:"가챠 마스터",description:"10번의 가챠를 완료했습니다",icon:"🏆",condition:r=>r.totalGachas>=10,xpReward:50},{id:"timing_expert",name:"타이밍 전문가",description:"5번의 완벽한 타이밍을 달성했습니다",icon:"🎖️",condition:r=>r.perfectTimings>=5,xpReward:100},{id:"veteran",name:"베테랑",description:"50번의 가챠를 완료했습니다",icon:"👑",condition:r=>r.totalGachas>=50,xpReward:200}],Pe=r=>Math.floor(r/100)+1,Ft=r=>r&&typeof r=="object"&&typeof r.level=="number"&&typeof r.xp=="number"&&typeof r.totalGachas=="number"&&typeof r.perfectTimings=="number"&&Array.isArray(r.achievements)&&Array.isArray(r.unlockedThemes)&&r.level>=1&&r.level<=1e3&&r.xp>=0&&r.totalGachas>=0&&r.perfectTimings>=0,Tt=()=>{try{const r=localStorage.getItem(ie);if(!r)return{...me};const n=JSON.parse(r);return Ft(n)?n:(console.warn("Invalid game stats detected, resetting to default"),localStorage.removeItem(ie),{...me})}catch(r){return console.error("Failed to load game stats:",r),localStorage.removeItem(ie),{...me}}},Ct=r=>{try{localStorage.setItem(ie,JSON.stringify(r))}catch(n){console.error("Failed to save game stats:",n)}},Pt=(r,n)=>{const o=r.level,s=r.xp+n,u=Pe(s),d={...r,xp:s,level:u},x=jt.filter(w=>!r.achievements.includes(w.id)&&w.condition(d));if(x.length>0){const w=x.reduce((v,b)=>v+b.xpReward,0);d.xp+=w,d.level=Pe(d.xp),d.achievements=[...r.achievements,...x.map(v=>v.id)],x.some(v=>v.id==="timing_expert")&&(d.unlockedThemes=[...d.unlockedThemes,"golden"]),x.some(v=>v.id==="veteran")&&(d.unlockedThemes=[...d.unlockedThemes,"rainbow"])}return{newStats:d,leveledUp:u>o,newAchievements:x}},It=(r,n)=>{let o=10;n==="perfect"?o+=15:n==="good"&&(o+=5);const s={...r,totalGachas:r.totalGachas+1,perfectTimings:n==="perfect"?r.perfectTimings+1:r.perfectTimings};return Pt(s,o)},Bt=()=>{const r=Ue(),n=qe(),{settings:o}=Ye(),[s,u]=I.useState("ready"),[d,x]=I.useState(null),[w,v]=I.useState(!1),[b,T]=I.useState("miss"),[B,E]=I.useState(0),[$,U]=I.useState({isActive:!1,startTime:0,targetZoneStart:1500,targetZoneEnd:2500,targetZonePosition:50,difficulty:"normal"}),[L,y]=I.useState(Tt()),[q,H]=I.useState([]),[Y,J]=I.useState(!1),[Q,X]=I.useState(),de="#F7F7F7",N=r.state?.items||[];I.useEffect(()=>{if(N.length<2){n("/");return}},[N.length,n]);const ue=()=>{u("animating"),v(!1),x(null);const A=ht(3e3,L,o.difficulty);U(A),setTimeout(()=>{u("timing")},500)},fe=A=>{T(A),U(i=>({...i,isActive:!1})),u("result");const te=Je(N);x(te);const re=gt(A,$.difficulty,L.consecutiveSuccess);E(re);const G=xt(L,A,re),ae=G.level>L.level;y(G),Ct(G),J(ae),X(ae?G.level:void 0);const{newAchievements:t}=It(L,A);H(t),setTimeout(()=>{v(!0)},A==="miss"?2e3:1e3)},pe=()=>{u("ready"),v(!1),x(null),T("miss"),E(0),H([]),J(!1),X(void 0)},he=()=>{n("/")},ee=()=>{H([]),J(!1),X(void 0)};return N.length<2?null:a.jsxs(z,{bg:de,minH:"100vh",py:8,position:"relative",children:[a.jsx(Qe,{maxW:"4xl",h:"90vh",children:a.jsxs(D,{spacing:8,align:"center",justify:"center",h:"full",children:[s==="ready"&&a.jsx(ut,{onStart:ue,gameStats:L,itemCount:N.length}),s==="animating"&&a.jsxs(a.Fragment,{children:[a.jsx(P,{fontSize:"2xl",fontWeight:"bold",color:"#FF6B6B",textAlign:"center",children:"🎯 가챠 애니메이션 시작!"}),a.jsx(Fe,{items:N})]}),s==="timing"&&a.jsxs(a.Fragment,{children:[a.jsx(P,{fontSize:"xl",fontWeight:"bold",color:"#FF6B6B",textAlign:"center",children:"⚡ 지금이야! 타이밍을 맞춰보세요!"}),a.jsx(Fe,{items:N}),a.jsx(yt,{timingGame:$,onStop:fe,animationDuration:3e3})]}),s==="result"&&a.jsxs(a.Fragment,{children:[d&&a.jsx(St,{item:d,showResult:w,timingAccuracy:b,xpGained:B}),w&&a.jsx(wt,{onRetry:pe,onGoHome:he})]})]})}),a.jsx(Mt,{newAchievements:q,leveledUp:Y,newLevel:Q,onComplete:ee})]})};export{Bt as default};
